<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>emba • emba</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="emba">
<meta property="og:description" content="emba">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">emba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/emba.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bblodfon/emba/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="emba_files/header-attrs-2.6/header-attrs.js"></script><script src="emba_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>emba</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bblodfon/emba/blob/master/vignettes/emba.Rmd"><code>vignettes/emba.Rmd</code></a></small>
      <div class="hidden name"><code>emba.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>The <em>emba</em> R package name stands for <em>Ensemble (Boolean) Model Biomarker Analysis</em>. It’s main purpose is to be used on a dataset consisted of an <strong>ensemble of boolean models</strong>. These models are usually (but not necessarily) different versions of the same initial model, parameterized in different ways (e.g. some boolean operators in the model equations have changed from <em>OR</em> to <em>AND</em> or vice-versa). A prerequisite for using this package, is that this model dataset must be tested in-silico (using some computational way) against a list of drug combinations, in order to assess which drugs combinations behave <em>synergistically</em> for which models. An example software that generates such boolean model ensembles and performs a comprehensive drug response analysis on them is the DrugLogics NTNU software pipeline (see respective <a href="https://druglogics.github.io/druglogics-doc/">documentation</a>).</p>
<p>Given a list of <em>gold-standard</em> (lab-observed/verified) <strong>synergies</strong> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, this package enables the easy grouping of the models into different classes based on a specific performance metric evaluation. This model classification enables the discovery and visualization of <strong>biomarkers</strong> - nodes whose <em>activity</em> and/or boolean model <em>parameterization</em> might affect either the prediction performance of those models or the manifestation of the predicted synergies.</p>
<p>In the next sections we will describe the main inputs and outputs of the <em>general analysis</em> functions (which group a lot of functionality into one) and provide some insights on the implementation behind. Biomarkers will be assessed and visualized using a test dataset generated from the DrugLogics software mentioned above.</p>
<p>The complementary R package <a href="https://github.com/bblodfon/usefun">usefun</a> has various helpful functions that are used both inside the <em>emba</em> package and during the analysis below.</p>
<p>For further analyses using this package on boolean model ensemble datasets see this <a href="https://github.com/druglogics/gitsbe-model-analysis/">GitHub repository</a>. See also <a href="https://druglogics.github.io/gitsbe-model-analysis/atopo/cell-lines-2500/">an example</a> that demonstrates all the intermediate steps included in the <em>general analysis</em> functions as well as other miscellaneous usages that this guide does not cover. Lastly, you might also want to check a <a href="https://bblodfon.github.io/r-pres/digital_life_2019.html#12">nice presentation</a> I made for a conference about this package.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bblodfon.github.io/emba/">emba</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bblodfon/usefun">usefun</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Ckmeans.1d.dp</span><span class="op">)</span>

<span class="co"># wrapper to change printing to invisible</span>
<span class="va">pr</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
</div>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<div id="test-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#test-dataset" class="anchor"></a>Test dataset</h2>
<p>The test dataset we will use has <span class="math inline">\(7500\)</span> boolean models with <span class="math inline">\(139\)</span> nodes each. It helps to think of each boolean model as a <strong>network of nodes</strong> where the edges represent either activation or inhibition of the corresponding target and the nodes activity can be either active (1) or inactive (0).</p>
<p>The models have been assessed for synergy against a total of <span class="math inline">\(153\)</span> drug combinations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data.list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://github.com/bblodfon/emba/blob/main/vignettes/data.rds?raw=true"</span><span class="op">)</span><span class="op">)</span>

<span class="va">model.predictions</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">model.predictions</span>
<span class="va">models.stable.state</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">models.stable.state</span>
<span class="va">models.link.operator</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">models.equations</span>
<span class="va">observed.synergies</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">observed.synergies</span>

<span class="co"># (x,y) coordinates for visualization</span>
<span class="va">nice.layout</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">nice.layout</span>
<span class="co"># model network as an igraph object</span>
<span class="va">net</span> <span class="op">=</span> <span class="va">data.list</span><span class="op">$</span><span class="va">net</span>

<span class="co"># drug combinations</span>
<span class="va">drug.combos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">)</span>

<span class="co"># change model names (shorter names for readability)</span>
<span class="va">model.names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7500</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">)</span> <span class="op">=</span> <span class="va">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">models.stable.state</span><span class="op">)</span> <span class="op">=</span> <span class="va">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">models.link.operator</span><span class="op">)</span> <span class="op">=</span> <span class="va">model.names</span></code></pre></div>
</div>
<div id="model-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#model-predictions" class="anchor"></a>Model Predictions</h2>
<p>This data represents the results of <strong>in-silico testing the boolean models against a drug combination dataset</strong>. More specifically, the model predictions is a <code>data.frame</code> whose values (corresponding to a specific <strong>model-drug combination element</strong>) can be one of the following:</p>
<ul>
<li>0 (no synergy predicted)</li>
<li>1 (synergy was predicted)</li>
<li>
<code>NA</code> (in case the model couldn’t be assessed for synergy, e.g. there were no stable states in either the drug combination perturbed model or in any of the two single-drug perturbed models).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model.predictions</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">77</span><span class="op">:</span><span class="fl">84</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Model predictions example"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Model predictions example</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">PI-JN</th>
<th align="right">PI-D1</th>
<th align="right">PI-60</th>
<th align="right">PI-SB</th>
<th align="right">PI-RU</th>
<th align="right">PI-D4</th>
<th align="right">PI-F4</th>
<th align="right">PI-ST</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">model1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">model3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="model-stable-states" class="section level2">
<h2 class="hasAnchor">
<a href="#model-stable-states" class="anchor"></a>Model stable states</h2>
<p>Each <strong>model</strong> must have a <em>stable state configuration</em> where the <strong>nodes</strong> have fixed to either 0 (inactive state) or 1 (active state). In other words, a <strong>fixpoint attractor</strong>. Of course, if a model has multiple attractors or other methods are used to derive a solution to the system of boolean equations that is the model itself, then <em>continuous</em> activity state values (in the <span class="math inline">\([0,1]\)</span> interval) are also supported.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models.stable.state</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Model stable states example"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Model stable states example</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKG</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">BRAF</th>
<th align="right">SMAD3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">model2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="model-link-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#model-link-operators" class="anchor"></a>Model link operators</h2>
<p>This is a non-essential input for the functions we will use, but we include it here since the test dataset supports it. It is a way to represent the <strong>structure (parameterization)</strong> of the boolean models in the dataset.</p>
<p>If each boolean model is a list of boolean equations of the form:</p>
<p><code>T = (A1 OR A2 OR ...) AND NOT (I1 OR I2 OR ...)</code></p>
<p>, where the <code>A</code> and <code>I</code> nodes are the activating and inhibiting regulators respectively of the <strong>target node</strong> <code>T</code> and the <code>AND NOT</code> is the <strong>link (balance) operator</strong>, we can specify a <code>data.frame</code> object whose values (corresponding to a specific <strong>model-target node element</strong>) can be one of the following:</p>
<ul>
<li>0 (<code>AND NOT</code> link operator)</li>
<li>1 (<code>OR NOT</code> link operator)</li>
<li>0.5 (if the target node does not have <em>both</em> activating and inhibiting regulators and thus the corresponding boolean equation has <strong>no link operator</strong>)</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models.link.operator</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Models link operator example"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Models link operator example</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">SMAD3</th>
<th align="right">GSK3B</th>
<th align="right">RAF1</th>
<th align="right">GAB2</th>
<th align="right">CTNNB1</th>
<th align="right">NR3C1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">model4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Note that in the test dataset, the nodes (columns of the <code>models.link.operator</code> object) who didn’t have a link operator are pruned.</p>
</div>
<div id="observed-gs-synergies" class="section level2">
<h2 class="hasAnchor">
<a href="#observed-gs-synergies" class="anchor"></a>Observed (GS) synergies</h2>
<p>A list of <em>gold standard (GS)</em> drug combinations which have been termed as <strong>synergistic</strong> via experimental and/or other computational methods. These drug combinations must be a subset of the ones tested in the models (the column names of the <code>model.predictions</code> data).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">observed.synergies</span>, vector.values.str <span class="op">=</span> <span class="st">"observed synergies"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>17 observed synergies: AK-60, AK-BI, AK-D1, PI-D1, PD-G2, AK-G4, D1-G4, PI-JN, BI-P5, PD-P5, PI-P5, AK-PD, BI-PD, AK-PI, BI-PI, PD-PI, PK-ST</p>
</blockquote>
</div>
</div>
<div id="performance-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#performance-biomarkers" class="anchor"></a>Performance biomarkers</h1>
<p><em>Performance biomarkers</em> are nodes in our studied networks (boolean models) whose activity state and/or boolean model parameterization (link operator) affects the prediction performance of those models. These nodes can be thus used as indicators of either <em>activity</em> or <em>structural</em> changes that have a positive effect on the prediction performance of our models.</p>
<p>The model performance can be assessed via various ways. In this package we offer two ways to group the models to different classification categories: either based on the <strong>number of true positive (TP) predictions</strong> or on the <strong>Matthews correlation coefficient (MCC) score</strong> with respect to the drug combination dataset tested for synergy. The function <code><a href="../reference/biomarker_tp_analysis.html">emba::biomarker_tp_analysis()</a></code> is used for the former classification and the function <code><a href="../reference/biomarker_mcc_analysis.html">emba::biomarker_mcc_analysis()</a></code> for the latter. Note that it’s generally better to use the MCC classification, since it’s a more robust performance evaluation metric compared to the number of TP predictions, since it takes into account all of the four confusion matrix values.</p>
<p>When the models have been grouped to different classification categories, their nodes activity or boolean model parameterization can be summarised in each group and compared to the others, obtaining thus the expected biomarkers using the methodology described below.</p>
<div id="tp-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#tp-based-analysis" class="anchor"></a>TP-based analysis</h2>
<p>We use the <code><a href="../reference/biomarker_tp_analysis.html">emba::biomarker_tp_analysis()</a></code> function with the specified inputs:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tp.analysis.res</span> <span class="op">=</span> <span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/biomarker_tp_analysis.html">biomarker_tp_analysis</a></span><span class="op">(</span>
  <span class="va">model.predictions</span>, 
  <span class="va">models.stable.state</span>, 
  <span class="va">models.link.operator</span>, 
  <span class="va">observed.synergies</span>, 
  penalty <span class="op">=</span> <span class="fl">0.1</span>,
  threshold <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span></code></pre></div>
<p>The <code>penalty</code> term is used to reduce the bias when model groups have different <em>sizes</em>. For example, if I were to compare the average activity of nodes between two groups of models, with respective group sizes 5 and 1000, then the result would be heavily biased towards the group with the larger size, making thus the quality of the results coming out of this comparison questionable. As such, with <code>penalty</code> values closer to 0, more bias is introduced and we expect more biomarkers to be found. The default value of <span class="math inline">\(0.1\)</span> is a good rule-of-thumb choice for minimizing such biases. See more info on <code><a href="../reference/get_vector_diff.html">emba::get_vector_diff()</a></code>.</p>
<hr>
<p>As a first result, we get the predicted synergies - i.e. the drug combinations that are a subset of the observed ones and were <strong>predicted by at least one</strong> of the models in the dataset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">predicted.synergies</span>, vector.values.str <span class="op">=</span> <span class="st">"predicted synergies"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>5 predicted synergies: AK-PD, BI-PD, BI-PI, PD-PI, PI-D1</p>
</blockquote>
<p>The percentage of true positive predicted synergies is thus 29.4%. Such a low number might be a sign that the models quality is poor (need for a different parameterization) or other reasons like incorrect assessment of the gold standard synergies, etc.</p>
<p>The next informative barplot shows the distribution of models according to their true positive predictions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/make_barplot_on_models_stats.html">make_barplot_on_models_stats</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">models.synergies.tp</span><span class="op">)</span>, 
  title <span class="op">=</span> <span class="st">"True Positive Synergy Predictions"</span>,
  xlab <span class="op">=</span> <span class="st">"Number of maximum correctly predicted synergies"</span>,
  ylab <span class="op">=</span> <span class="st">"Number of models"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/tp-analysis-3-1.png" width="672" style="display: block; margin: auto;"></p>
<ul>
<li>The <strong>maximum number of predicted synergies by any individual model</strong> is 3</li>
<li>There are only 2 models in total that could predict these 3 synergies</li>
<li>Almost half of the models make no true positive predictions</li>
<li>This model classification is largely <em>skewed</em>
</li>
</ul>
<p>Next result we get is the <strong>average activity differences</strong> per network node for all group classifications:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">diff.state.tp.mat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AKT"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"STAT3"</span>,<span class="st">"CEBPA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Average Activity Difference Matrix"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Average Activity Difference Matrix</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AKT</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">STAT3</th>
<th align="right">CEBPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(0,1)</td>
<td align="right">-0.0278105</td>
<td align="right">0.4462906</td>
<td align="right">-0.0012761</td>
<td align="right">0.2316447</td>
<td align="right">0.0283239</td>
</tr>
<tr class="even">
<td align="left">(0,2)</td>
<td align="right">-0.0851093</td>
<td align="right">0.3814671</td>
<td align="right">0.0104114</td>
<td align="right">0.0200058</td>
<td align="right">0.0118586</td>
</tr>
<tr class="odd">
<td align="left">(0,3)</td>
<td align="right">0.0175886</td>
<td align="right">0.2594653</td>
<td align="right">0.4728458</td>
<td align="right">-0.3232749</td>
<td align="right">0.4327603</td>
</tr>
<tr class="even">
<td align="left">(1,2)</td>
<td align="right">-0.0630977</td>
<td align="right">0.0363188</td>
<td align="right">0.0113038</td>
<td align="right">-0.1576796</td>
<td align="right">-0.0099449</td>
</tr>
<tr class="odd">
<td align="left">(1,3)</td>
<td align="right">0.0306321</td>
<td align="right">0.0456991</td>
<td align="right">0.4695673</td>
<td align="right">-0.4304678</td>
<td align="right">0.4157744</td>
</tr>
<tr class="even">
<td align="left">(2,3)</td>
<td align="right">0.0916724</td>
<td align="right">0.0305575</td>
<td align="right">0.6086029</td>
<td align="right">-0.4379904</td>
<td align="right">0.5551273</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows represent the different classification group matchings, e.g. (1,2) means the models that predicted 1 TP synergy vs the models that predicted 2 TP synergies.</li>
<li>All values are in the <span class="math inline">\([-1,1]\)</span> interval. The more negative the activity difference value, the more <em>inhibited</em> the node is in the better performance models (e.g. <code>STAT3</code> node). The more positive the activity difference value, the more <em>active</em> the node is in the better performance models (e.g. <code>CEBPA</code> node).</li>
<li>Based on a <strong>user-given</strong> <code>threshold</code> level, a node is declared as an <strong>activity biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.55</code> and thus <code>CEBPA</code> and <code>PSEN1</code> are returned as active biomarkers:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">biomarkers.tp.active</span>,
  vector.values.str <span class="op">=</span> <span class="st">"active biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>2 active biomarkers: PSEN1, CEBPA</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">biomarkers.tp.inhibited</span>,
  vector.values.str <span class="op">=</span> <span class="st">"inhibited biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>0 inhibited biomarkers:</p>
</blockquote>
<p>With the models initial network as an <a href="https://igraph.org/r/">igraph</a> object (see <code><a href="../reference/construct_network.html">emba::construct_network()</a></code> on how to create such a <code>net</code> object), we can visualize every row of the above matrix as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_avg_state_diff_graph.html">plot_avg_state_diff_graph</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">diff.state.tp.mat</span><span class="op">[</span><span class="st">"(2,3)"</span>,<span class="op">]</span>, 
  layout <span class="op">=</span> <span class="va">nice.layout</span>, title <span class="op">=</span> <span class="st">"Bad models (2 TP) vs Good models (3 TP)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/tp-analysis-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that with less <code>penalty</code>, more bias would be introduced and thus more biomarkers would be found (even for a higher chosen <code>threshold</code>):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tp.analysis.res.biased</span> <span class="op">=</span> <span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/biomarker_tp_analysis.html">biomarker_tp_analysis</a></span><span class="op">(</span>
  <span class="va">model.predictions</span>, 
  <span class="va">models.stable.state</span>, 
  <span class="va">models.link.operator</span>, 
  <span class="va">observed.synergies</span>, 
  penalty <span class="op">=</span> <span class="fl">0</span>,
  threshold <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>

<span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res.biased</span><span class="op">$</span><span class="va">biomarkers.tp.active</span>,
  vector.values.str <span class="op">=</span> <span class="st">"active biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>13 active biomarkers: PSEN1, CEBPA, MAPK8IP1, MAPK9, JAK1, TYK2, JAK3, IFNGR2/INFGR1, IFNGR1, PTPN11, IFNGR2, IL2RB, IL10RA</p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res.biased</span><span class="op">$</span><span class="va">biomarkers.tp.inhibited</span>,
  vector.values.str <span class="op">=</span> <span class="st">"inhibited biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>17 inhibited biomarkers: MAP3K7, MAP2K6, MAP2K3, NLK, IKBKG, STAT3, RXRA, SOCS3, TGFB1, HSPA1A, SALL4, ROCK1, TGFBR1, TRAF6, RHOA, PIK3R1, CASP9</p>
</blockquote>
<p>Last result we get is the <strong>average link operator differences</strong> per network node (whose boolean equation had a link operator) for all group classifications:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">diff.link.tp.mat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AKT"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"STAT3"</span>,<span class="st">"CEBPA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Average Link Operator Difference Matrix"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Average Link Operator Difference Matrix</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AKT</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">STAT3</th>
<th align="right">CEBPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(0,1)</td>
<td align="right">0.2019689</td>
<td align="right">0.4291810</td>
<td align="right">-0.0047786</td>
<td align="right">0.2316447</td>
<td align="right">0.0269599</td>
</tr>
<tr class="even">
<td align="left">(0,2)</td>
<td align="right">0.1116284</td>
<td align="right">0.3682466</td>
<td align="right">-0.1722642</td>
<td align="right">0.0200058</td>
<td align="right">0.0101784</td>
</tr>
<tr class="odd">
<td align="left">(0,3)</td>
<td align="right">0.1588424</td>
<td align="right">0.2512846</td>
<td align="right">0.2915064</td>
<td align="right">-0.3232749</td>
<td align="right">0.4356235</td>
</tr>
<tr class="even">
<td align="left">(1,2)</td>
<td align="right">-0.0440675</td>
<td align="right">0.0363188</td>
<td align="right">-0.1671873</td>
<td align="right">-0.1576796</td>
<td align="right">-0.0105660</td>
</tr>
<tr class="odd">
<td align="left">(1,3)</td>
<td align="right">0.0617622</td>
<td align="right">0.0456991</td>
<td align="right">0.2913783</td>
<td align="right">-0.4304678</td>
<td align="right">0.4192610</td>
</tr>
<tr class="even">
<td align="left">(2,3)</td>
<td align="right">0.1171370</td>
<td align="right">0.0305575</td>
<td align="right">0.5194769</td>
<td align="right">-0.4379904</td>
<td align="right">0.5602202</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows again represent the different classification group matchings, e.g. (1,2) means the models that predicted 1 TP synergy vs the models that predicted 2 TP synergies.</li>
<li>All values are in the <span class="math inline">\([-1,1]\)</span> interval. A value closer to <span class="math inline">\(-1\)</span> means that on average, the node’s boolean equation has the <em>AND NOT</em> link operator in the better performance models (e.g. <code>STAT3</code> node). A value closer to <span class="math inline">\(1\)</span> means that on average, the node’s boolean equation has mostly the <em>OR NOT</em> link operator in the better performance models (e.g. <code>CEBPA</code> node).</li>
<li>Based on the given <code>threshold</code> level, a node is declared as a <strong>link operator biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.55</code> and thus <code>CEBPA</code> is returned as an <code>OR</code> link operator biomarker:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">biomarkers.tp.or</span>,
  vector.values.str <span class="op">=</span> <span class="st">"'OR' biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>1 ‘OR’ biomarker: CEBPA</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">biomarkers.tp.and</span>,
  vector.values.str <span class="op">=</span> <span class="st">"'AND' biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>0 ‘AND’ biomarkers:</p>
</blockquote>
<p>We can also visualize every row of the average link operator differences matrix as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_avg_link_operator_diff_graph.html">plot_avg_link_operator_diff_graph</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">tp.analysis.res</span><span class="op">$</span><span class="va">diff.link.tp.mat</span><span class="op">[</span><span class="st">"(2,3)"</span>,<span class="op">]</span>, 
  layout <span class="op">=</span> <span class="va">nice.layout</span>, title <span class="op">=</span> <span class="st">"Bad models (2 TP) vs Good models (3 TP)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/tp-analysis-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Interpreting the result regarding the <code>CEBPA</code> biomarker, we look back at its boolean equation and we see that the higher performance models must have the <code>OR NOT</code> link operator in order for <code>CEBPA</code> to be in an active (ON) state (an <code>AND NOT</code> results mostly on an inhibited state for <code>CEBPA</code>):</p>
<p><code>CEBPA = (GSK3B OR MAP2K1 OR MEK1/2) OR NOT CTNNB1</code></p>
</div>
<div id="mcc-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#mcc-based-analysis" class="anchor"></a>MCC-based analysis</h2>
<p>We use the <code><a href="../reference/biomarker_mcc_analysis.html">emba::biomarker_mcc_analysis()</a></code> function with the specified inputs:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcc.analysis.res</span> <span class="op">=</span> <span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/biomarker_mcc_analysis.html">biomarker_mcc_analysis</a></span><span class="op">(</span>
  <span class="va">model.predictions</span>, 
  <span class="va">models.stable.state</span>, 
  <span class="va">models.link.operator</span>, 
  <span class="va">observed.synergies</span>, 
  threshold <span class="op">=</span> <span class="fl">0.65</span>,
  num.of.mcc.classes <span class="op">=</span> <span class="fl">4</span>,
  penalty <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<ul>
<li>The <code>penalty</code> term is used to reduce the bias when model groups have different <em>sizes</em> (default value is <span class="math inline">\(0.1\)</span>). See more info about this on the TP-based analysis above and on the documentation of the function <code><a href="../reference/get_vector_diff.html">emba::get_vector_diff()</a></code>.</li>
<li>We can choose the number of model groups to be created (<code>num.of.mcc.classes</code> parameter, with default value <span class="math inline">\(5\)</span>). Internally, the function <code><a href="https://rdrr.io/pkg/Ckmeans.1d.dp/man/Ckmeans.1d.dp.html">Ckmeans.1d.dp()</a></code> is used to perform an optimal univariate <em>k-means</em> clustering on the models MCC scores, i.e. <strong>it groups the models to different MCC classes</strong>, with higher classes having higher MCC scores (corresponding thus to better performance models).</li>
</ul>
<hr>
<p>First result is the predicted synergies, which are the same as the ones found with the TP-based analysis (the model predictions did not change). As such, the drug combinations which were <strong>predicted by at least one of the models</strong> in the dataset are:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">predicted.synergies</span>, vector.values.str <span class="op">=</span> <span class="st">"predicted synergies"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>5 predicted synergies: AK-PD, BI-PD, BI-PI, PD-PI, PI-D1</p>
</blockquote>
<p>We can get a first idea of the range and distribution of the models MCC scores with the next barplot:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/make_barplot_on_models_stats.html">make_barplot_on_models_stats</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">models.mcc</span><span class="op">)</span>, 
  title <span class="op">=</span> <span class="st">"MCC scores"</span>, xlab <span class="op">=</span> <span class="st">"MCC value"</span>, 
  ylab <span class="op">=</span> <span class="st">"Number of models"</span>, cont.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/mcc-analysis-3-1.png" width="672" style="display: block; margin: auto;"></p>
<ul>
<li>There are no relatively bad models (MCC values close to <span class="math inline">\(-1\)</span>)</li>
<li>Most of the models perform a little better than random prediction (<span class="math inline">\(MCC &gt; 0\)</span>)</li>
</ul>
<p>We can also plot the <strong>MCC-model histogram</strong>, which in addition shows the estimated <em>density</em> (how many models) and <em>width</em> (MCC range) of each MCC class:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">models.mcc</span> <span class="op">=</span> <span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">models.mcc</span>
<span class="va">num.of.mcc.classes</span> <span class="op">=</span> <span class="fl">4</span>

<span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Ckmeans.1d.dp/man/Ckmeans.1d.dp.html">Ckmeans.1d.dp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">models.mcc</span>, k <span class="op">=</span> <span class="va">num.of.mcc.classes</span><span class="op">)</span>
<span class="va">models.cluster.ids</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">cluster</span>

<span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mcc_classes_hist.html">plot_mcc_classes_hist</a></span><span class="op">(</span><span class="va">models.mcc</span>, <span class="va">models.cluster.ids</span>, <span class="va">num.of.mcc.classes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/mcc-analysis-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Next result we get is the <strong>average activity differences</strong> per network node for all group classifications:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">diff.state.mcc.mat</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AKT"</span>,<span class="st">"PPM1A"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"PTK2"</span>,<span class="st">"CEBPA"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Average Activity Difference Matrix"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Average Activity Difference Matrix</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AKT</th>
<th align="right">PPM1A</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">PTK2</th>
<th align="right">CEBPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(1,2)</td>
<td align="right">-0.0263106</td>
<td align="right">0.5637404</td>
<td align="right">0.5637404</td>
<td align="right">0.0002462</td>
<td align="right">-0.5637404</td>
<td align="right">-0.0180814</td>
</tr>
<tr class="even">
<td align="left">(1,3)</td>
<td align="right">-0.0419764</td>
<td align="right">0.6791224</td>
<td align="right">0.6791224</td>
<td align="right">-0.0004583</td>
<td align="right">-0.6791224</td>
<td align="right">0.0189502</td>
</tr>
<tr class="odd">
<td align="left">(1,4)</td>
<td align="right">-0.0551735</td>
<td align="right">0.6416618</td>
<td align="right">0.6416618</td>
<td align="right">0.0039844</td>
<td align="right">-0.6416618</td>
<td align="right">-0.0054756</td>
</tr>
<tr class="even">
<td align="left">(2,3)</td>
<td align="right">-0.0196324</td>
<td align="right">0.1787135</td>
<td align="right">0.1787135</td>
<td align="right">-0.0007511</td>
<td align="right">-0.1787135</td>
<td align="right">0.0390053</td>
</tr>
<tr class="odd">
<td align="left">(2,4)</td>
<td align="right">-0.0300506</td>
<td align="right">0.1517566</td>
<td align="right">0.1517566</td>
<td align="right">0.0034388</td>
<td align="right">-0.1517566</td>
<td align="right">0.0088853</td>
</tr>
<tr class="even">
<td align="left">(3,4)</td>
<td align="right">-0.0138152</td>
<td align="right">0.0141918</td>
<td align="right">0.0141918</td>
<td align="right">0.0036747</td>
<td align="right">-0.0141918</td>
<td align="right">-0.0191041</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows represent the different classification group matchings, e.g. (1,2) means the models that were in the 1st MCC class vs the models that were in the 2nd MCC class.</li>
<li>All values are in the <span class="math inline">\([-1,1]\)</span> interval. The more negative the activity difference value, the more inhibited the node is in the better performance models (e.g. <code>PTK2</code>). The more positive the activity difference value, the more active the node is in the better performance models (e.g. <code>PPM1A,PTEN</code>).</li>
<li>Based on a <strong>user-given</strong> <code>threshold</code> level, a node is declared as an <strong>activity biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.65</code> and thus <code>PTEN</code> and <code>PPM1A</code> are returned as active biomarkers and <code>PTK2</code> as an inhibited biomarker:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">biomarkers.mcc.active</span>,
  vector.values.str <span class="op">=</span> <span class="st">"active biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>2 active biomarkers: PTEN, PPM1A</p>
</blockquote>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">biomarkers.mcc.inhibited</span>,
  vector.values.str <span class="op">=</span> <span class="st">"inhibited biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>1 inhibited biomarker: PTK2</p>
</blockquote>
<p>Note that looking at the respective boolean equations:</p>
<ul>
<li><code>PPM1A = PTEN</code></li>
<li><code>PTK2 = not PTEN</code></li>
</ul>
<p>we conclude that <strong>the only activity biomarker of interest</strong> is <code>PTEN</code> as it’s the only regulator whose state directly influences the <code>PPM1A</code> and <code>PTK2</code> nodes.</p>
<p>With the models initial network as an <a href="https://igraph.org/r/">igraph</a> object (see <code><a href="../reference/construct_network.html">emba::construct_network()</a></code> on how to create such a <code>net</code> object), we can visualize every row of the above matrix as follows:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_avg_state_diff_graph.html">plot_avg_state_diff_graph</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">diff.state.mcc.mat</span><span class="op">[</span><span class="st">"(1,4)"</span>,<span class="op">]</span>, 
  layout <span class="op">=</span> <span class="va">nice.layout</span>, title <span class="op">=</span> <span class="st">"Bad models (MCC Class 1) vs Good models (MCC Class 4)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/mcc-analysis-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Last result we get is the <strong>average link operator differences</strong> per network node (whose boolean equation had a link operator) for all group classifications:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">diff.link.mcc.mat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AKT"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"CEBPA"</span>,<span class="st">"STAT3"</span>,<span class="st">"JAK1"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Average Link Operator Difference Matrix"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Average Link Operator Difference Matrix</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AKT</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">CEBPA</th>
<th align="right">STAT3</th>
<th align="right">JAK1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(1,2)</td>
<td align="right">0.2793768</td>
<td align="right">0.5880847</td>
<td align="right">0.0466807</td>
<td align="right">-0.0280618</td>
<td align="right">-0.3069948</td>
<td align="right">0.2806183</td>
</tr>
<tr class="even">
<td align="left">(1,3)</td>
<td align="right">0.3182545</td>
<td align="right">0.6791224</td>
<td align="right">0.0115062</td>
<td align="right">0.0114039</td>
<td align="right">0.0664054</td>
<td align="right">-0.0648736</td>
</tr>
<tr class="odd">
<td align="left">(1,4)</td>
<td align="right">0.2860364</td>
<td align="right">0.6416618</td>
<td align="right">-0.0109073</td>
<td align="right">-0.0060220</td>
<td align="right">-0.6043843</td>
<td align="right">0.5783232</td>
</tr>
<tr class="even">
<td align="left">(2,3)</td>
<td align="right">0.0684637</td>
<td align="right">0.1542205</td>
<td align="right">-0.0343283</td>
<td align="right">0.0407584</td>
<td align="right">0.3818048</td>
<td align="right">-0.3535848</td>
</tr>
<tr class="odd">
<td align="left">(2,4)</td>
<td align="right">0.0461114</td>
<td align="right">0.1330813</td>
<td align="right">-0.0457409</td>
<td align="right">0.0160442</td>
<td align="right">-0.3147733</td>
<td align="right">0.3112794</td>
</tr>
<tr class="even">
<td align="left">(3,4)</td>
<td align="right">-0.0055788</td>
<td align="right">0.0141918</td>
<td align="right">-0.0179237</td>
<td align="right">-0.0137708</td>
<td align="right">-0.5550172</td>
<td align="right">0.5321063</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows again represent the different classification group matchings, e.g. (1,2) means the models that were in the 1st MCC class vs the models that were in the 2nd MCC class.</li>
<li>All values are in the <span class="math inline">\([-1,1]\)</span> interval. A value closer to <span class="math inline">\(-1\)</span> means that on average, the node’s boolean equation has the <em>AND NOT</em> link operator in the better performance models (e.g. <code>STAT3</code> node). A value closer to <span class="math inline">\(1\)</span> means that on average, the node’s boolean equation has mostly the <em>OR NOT</em> link operator in the better performance models (e.g. <code>PTEN</code> node).</li>
<li>Based on the given <code>threshold</code> level, a node is declared as a <strong>link operator biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.65</code> and thus <code>PTEN</code> is returned as an <code>OR</code> link operator biomarker:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">biomarkers.mcc.or</span>,
  vector.values.str <span class="op">=</span> <span class="st">"'OR' biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>1 ‘OR’ biomarker: PTEN</p>
</blockquote>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span><span class="op">(</span><span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">biomarkers.mcc.and</span>,
  vector.values.str <span class="op">=</span> <span class="st">"'AND' biomarkers"</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>0 ‘AND’ biomarkers:</p>
</blockquote>
<p>We can also visualize every row of the average link operator differences matrix as in the following example:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_avg_link_operator_diff_graph.html">plot_avg_link_operator_diff_graph</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">mcc.analysis.res</span><span class="op">$</span><span class="va">diff.link.mcc.mat</span><span class="op">[</span><span class="st">"(1,4)"</span>,<span class="op">]</span>, 
  layout <span class="op">=</span> <span class="va">nice.layout</span>, title <span class="op">=</span> <span class="st">"Bad models (MCC Class 1) vs Good models (MCC Class 4)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/mcc-analysis-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="comparing-the-2-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-2-methods" class="anchor"></a>Comparing the 2 methods</h2>
<p>Overall, we note that <strong>using the more robust MCC score</strong> to classify the models according to their prediction performance on the drug combination dataset they were tested on, <strong>produces more reliable biomarkers</strong> compared to using the simple number of true positive predictions. In addition, the biomarker results are different between the 2 methods, e.g. the TP-analysis revealed <code>CEBPA</code> as an active state performance biomarker whereas the MCC-based analysis showed <code>PTEN</code> to be so.</p>
</div>
</div>
<div id="synergy-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#synergy-biomarkers" class="anchor"></a>Synergy biomarkers</h1>
<p><em>Synergy</em> biomarkers are nodes in our studied networks (boolean models) whose activity state and/or boolean model parameterization (link operator) affects the manifestation of synergies. These nodes can be thus used as indicators of either <em>activity</em> or <em>structural</em> changes that make the models <strong>predict specific drug combinations as synergistic</strong>.</p>
<p>The core idea behind the implementation is that the models are now classified to groups based on whether they <strong>predict or not each one of the predicted synergies</strong> (which for the test dataset are the same 5 as found with the previous analyses). Thus, by comparing the average node activity or boolean model parameterization from the group that predicted a drug combination as a <strong>synergy</strong> vs the group that predicted it to be an <strong>antagonism</strong>, we can derive biomarkers for that drug combination.</p>
<p>The function used to perform such an analysis is the <code><a href="../reference/biomarker_tp_analysis.html">emba::biomarker_tp_analysis()</a></code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">synergy.analysis.res</span> <span class="op">=</span> <span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/biomarker_synergy_analysis.html">biomarker_synergy_analysis</a></span><span class="op">(</span>
  <span class="va">model.predictions</span>,
  <span class="va">models.stable.state</span>,
  <span class="va">models.link.operator</span>,
  <span class="va">observed.synergies</span>,
  threshold <span class="op">=</span> <span class="fl">0.5</span>,
  calculate.subsets.stats <span class="op">=</span> <span class="cn">TRUE</span>,
  penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<hr>
<p>Now in addition to the predicted synergies set, we get all the <strong>subsets</strong> for which a model predicted all drug combinations in that subset as <em>synergistic</em>. We can visualize this result with the <code><a href="../reference/make_barplot_on_synergy_subset_stats.html">emba::make_barplot_on_synergy_subset_stats()</a></code> function:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/make_barplot_on_synergy_subset_stats.html">make_barplot_on_synergy_subset_stats</a></span><span class="op">(</span>
  <span class="va">synergy.analysis.res</span><span class="op">$</span><span class="va">synergy.subset.stats</span>,
  threshold.for.subset.removal <span class="op">=</span> <span class="fl">1</span>, 
  bottom.mar <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/synergy-analysis-2-1.png" width="672" style="display: block; margin: auto;"></p>
<ul>
<li>Almost half of the models (<span class="math inline">\(3478\)</span>) predict none of the <em>gold standard</em> synergies</li>
<li>The <code>PI-D1</code> synergy is predicted by almost all the rest of the models</li>
<li>There were only <span class="math inline">\(2\)</span> models that predicted <span class="math inline">\(3\)</span> gold standard synergies, i.e. the set <code>BI-PD,PD-PI,PI-D1</code> which is the maximum number of predicted synergies by an individual model</li>
</ul>
<p>Next result is the matrix of <em>activity state differences</em> vectors, one for each of the predicted synergies:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">synergy.analysis.res</span><span class="op">$</span><span class="va">diff.state.synergies.mat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Average State Differences per Synergy Predicted"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Average State Differences per Synergy Predicted</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">MAP3K7</th>
<th align="right">MAP2K6</th>
<th align="right">MAP2K3</th>
<th align="right">NLK</th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKG</th>
<th align="right">IKBKB</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AK-PD</td>
<td align="right">0.104</td>
<td align="right">0.104</td>
<td align="right">0.104</td>
<td align="right">0.104</td>
<td align="right">-0.016</td>
<td align="right">0.054</td>
<td align="right">0.104</td>
<td align="right">0.016</td>
</tr>
<tr class="even">
<td align="left">BI-PD</td>
<td align="right">-0.790</td>
<td align="right">-0.790</td>
<td align="right">-0.790</td>
<td align="right">-0.790</td>
<td align="right">-0.026</td>
<td align="right">-0.416</td>
<td align="right">-0.790</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">BI-PI</td>
<td align="right">0.045</td>
<td align="right">0.045</td>
<td align="right">0.045</td>
<td align="right">0.045</td>
<td align="right">0.004</td>
<td align="right">0.044</td>
<td align="right">0.045</td>
<td align="right">0.018</td>
</tr>
<tr class="even">
<td align="left">PD-PI</td>
<td align="right">-0.314</td>
<td align="right">-0.314</td>
<td align="right">-0.314</td>
<td align="right">-0.314</td>
<td align="right">0.005</td>
<td align="right">-0.147</td>
<td align="right">-0.314</td>
<td align="right">-0.033</td>
</tr>
<tr class="odd">
<td align="left">PI-D1</td>
<td align="right">0.080</td>
<td align="right">0.080</td>
<td align="right">0.080</td>
<td align="right">0.080</td>
<td align="right">0.002</td>
<td align="right">0.103</td>
<td align="right">0.080</td>
<td align="right">-0.018</td>
</tr>
</tbody>
</table>
<ul>
<li>Every row refers to a different predicted synergy in the dataset. The columns are the network nodes.</li>
<li>Every row is the result of <strong>comparing two model groups</strong>: the <em>synergistic group</em> (models that predicted the row-annotated drug combination as <strong>synergistic</strong>) vs the <em>antagonistic group</em> (models that predicted the row-annotated drug combination as <strong>antagonistic</strong>).</li>
<li>All values are in the <span class="math inline">\([−1,1]\)</span> interval. The more negative (positive) the activity difference value, the more inhibited (active) the node is in the synergistic model group.</li>
<li>Based on a <strong>user-given</strong> <code>threshold</code> level, a node for a specific synergy is declared as an <strong>activity biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>Every row of the above matrix can be also network-plotted. We show for example the average state difference graph for the <code>PI-D1</code> synergy:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pr</span><span class="op">(</span><span class="fu">emba</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_avg_state_diff_graph.html">plot_avg_state_diff_graph</a></span><span class="op">(</span><span class="va">net</span>,
  <span class="va">synergy.analysis.res</span><span class="op">$</span><span class="va">diff.state.synergies.mat</span><span class="op">[</span><span class="st">"PI-D1"</span>,<span class="op">]</span>,
  layout <span class="op">=</span> <span class="va">nice.layout</span>, title <span class="op">=</span> <span class="st">"Prediction of PI-D1 (Good Models: synergy, Bad Models: antagonism)"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="emba_files/figure-html/synergy-analysis-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Given the <strong>user-defined</strong> <code>threshold</code> (<span class="math inline">\(0.5\)</span>) we also get as a result the activity state biomarkers:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prune nodes (columns) that were not found as biomarkers for any predicted synergy</span>
<span class="va">biomarker.act.mat</span> <span class="op">=</span> <span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/prune_columns_from_df.html">prune_columns_from_df</a></span><span class="op">(</span>
  df <span class="op">=</span> <span class="va">synergy.analysis.res</span><span class="op">$</span><span class="va">activity.biomarkers</span>, value <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">biomarker.act.mat</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Activity State Biomarkers Per Synergy Predicted"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Activity State Biomarkers Per Synergy Predicted</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">NLK</th>
<th align="right">IKBKG</th>
<th align="right">CREB1</th>
<th align="right">STAT3</th>
<th align="right">PTEN</th>
<th align="right">PtsIns(3,4,5)P3</th>
<th align="right">JAK1</th>
<th align="right">TYK2</th>
<th align="right">JAK3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AK-PD</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">BI-PD</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">BI-PI</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">PD-PI</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">PI-D1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ul>
<li>In the above matrix, <span class="math inline">\(1\)</span> means <em>active state biomarker</em>, <span class="math inline">\(-1\)</span> <em>inhibited state biomarker</em> and <span class="math inline">\(0\)</span> means not a biomarker.</li>
<li>Using the following code, you can filter and derive your own activity biomarkers matrix:</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define your own threshold</span>
<span class="va">my.thres</span> <span class="op">=</span> <span class="fl">0.76</span>
<span class="va">activity.biomarkers.new</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>
  <span class="va">synergy.analysis.res</span><span class="op">$</span><span class="va">diff.state.synergies.mat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, 
  <span class="fu">usefun</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/usefun/man/get_ternary_class_id.html">get_ternary_class_id</a></span>, <span class="va">my.thres</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Note that there were predicted synergies (rows in the above matrix), for which we couldn’t find activity biomarkers (row was all zeros). This is justifiable, since <strong>the number of models in the synergistic and antagonistic model groups can be fairly unbalanced</strong> and the <code>penalty</code> term is used to correct this bias. For example, comparing the models that predict <code>AK-PD</code> as synergistic vs those that predict it as antagonistic, we have:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">drug.comb</span> <span class="op">=</span> <span class="st">"AK-PD"</span>

<span class="va">syn.models.num</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">[</span>, <span class="va">drug.comb</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">[</span>, <span class="va">drug.comb</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">ant.models.num</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">[</span>, <span class="va">drug.comb</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">model.predictions</span><span class="op">[</span>, <span class="va">drug.comb</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="fu">usefun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_string.html">pretty_print_string</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Number of models (AK-PD): #Synergistic: "</span>, <span class="va">syn.models.num</span>, <span class="st">", #Antagonistic: "</span>, <span class="va">ant.models.num</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<blockquote>
<p>Number of models (AK-PD): #Synergistic: 3, #Antagonistic: 6214</p>
</blockquote>
<p>Lastly, the <code>synergy.analysis.res$diff.link.synergies.mat</code> result is a matrix that contains the <strong>average link operator differences</strong> per network node (whose boolean equation had a link operator) when comparing the synergistic vs antagonistic model groups for each predicted synergy. The corresponding <strong>link operator biomarkers</strong> (based on the given <code>threshold</code>) are given in the <code>synergy.analysis.res$link.operator.biomarkers</code> output.</p>
</div>
<div id="r-session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#r-session-info" class="anchor"></a>R Session Info</h1>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>R version 3.6.3 (2020-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] Ckmeans.1d.dp_4.3.3 knitr_1.30          dplyr_1.0.2        
[4] usefun_0.4.8        emba_0.1.8         

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.5        highr_0.8         compiler_3.6.3    pillar_1.4.7     
 [5] tools_3.6.3       digest_0.6.27     jsonlite_1.7.2    evaluate_0.14    
 [9] memoise_1.1.0     lifecycle_0.2.0   tibble_3.0.4      pkgconfig_2.0.3  
[13] rlang_0.4.9       igraph_1.2.6      rstudioapi_0.13   yaml_2.2.1       
[17] pkgdown_1.6.1     xfun_0.19         stringr_1.4.0     htmlwidgets_1.5.3
[21] hms_0.5.3         desc_1.2.0        generics_0.1.0    fs_1.5.0         
[25] vctrs_0.3.5       systemfonts_0.3.2 gbRd_0.4-11       rprojroot_2.0.2  
[29] tidyselect_1.1.0  rje_1.10.16       glue_1.4.2        R6_2.5.0         
[33] textshaping_0.2.1 Rdpack_2.1        rmarkdown_2.6     tidyr_1.1.2      
[37] readr_1.4.0       purrr_0.3.4       magrittr_2.0.1    htmltools_0.5.0  
[41] ellipsis_0.3.1    rbibutils_2.0     assertthat_0.2.1  ragg_0.4.0       
[45] stringi_1.5.3     visNetwork_2.0.9  crayon_1.3.4     </code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the assessment of these synergies based on experimental data (usually High-Throughput Screening data) is an analysis on its own<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Zobolas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
